<% content_for :javascript do %>
  <style type="text/css">
    .status_true{
    }
    .status_false{
      color: red;
    }
  </style>
  <script type="text/javascript">
    var delta_time = 1000;
    var last_line = -1;
    var a;

    function ajaxCommandLogsRequest(){
      $.ajax({
        type : 'GET',
        url : '/command_logs/command_log_info',
        data : { from_line : (last_line + 1)},
        complete: function(resp){
          response = JSON.parse(resp.response);
          last_line = response["last_line"];
          a = response;
          refreshCommandLogsContent(response["command_log_lines"]);
          setTimeout(function(){ ajaxCommandLogsRequest(); }, delta_time);
        }
      });
    }
    function refreshCommandLogsContent(command_log_lines){
      if (command_log_lines != null){
        processed_command_log_lines = command_log_lines.map(function(line){
          return "<h5>"+ line["time"] +"<spam class='status_" + line["status"] + "'>" + line["message"] + "</spam> <img src='/images/check_" + line["status"] + ".png'>" + "</h5>"
        });
        $('#content_for_command_log').append(processed_command_log_lines.join("\n"));
      };
    }
    ajaxCommandLogsRequest();
  </script>
<% end %>
<% content_for :title, t('menu.command_log') %>
<% heading t('menu.command_log') %>

<div id="content_for_command_log"></div>
